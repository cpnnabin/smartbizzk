<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Sales Invoices - SmartBiz</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #29AD81;
            --primary-dark: #218a68;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --info-color: #17a2b8;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f8f9fa;
        }

        .header-card {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            border: none;
            box-shadow: 0 8px 25px rgba(41, 173, 129, 0.2);
        }

        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
            border-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(41, 173, 129, 0.3);
        }

        .table-hover tbody tr:hover {
            background-color: rgba(41, 173, 129, 0.1);
            transform: scale(1.01);
            transition: all 0.2s ease;
        }

        .card {
            border: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        .card:hover {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .badge-paid {
            background-color: var(--success-color);
            color: white;
            font-weight: 500;
            padding: 0.5em 0.75em;
            border-radius: 0.5rem;
        }

        .badge-pending {
            background-color: var(--warning-color);
            color: #212529;
            font-weight: 500;
            padding: 0.5em 0.75em;
            border-radius: 0.5rem;
        }

        .badge-overdue {
            background-color: var(--danger-color);
            color: white;
            font-weight: 500;
            padding: 0.5em 0.75em;
            border-radius: 0.5rem;
        }

        .btn-group .btn {
            transition: all 0.2s ease;
        }

        .btn-outline-primary:hover,
        .btn-outline-info:hover,
        .btn-outline-danger:hover {
            transform: translateY(-1px);
        }

        .filter-buttons .btn {
            margin-right: 0.25rem;
            transition: all 0.3s ease;
        }

        .filter-buttons .btn.active {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
        }

        .empty-state {
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .invoice-number {
            font-family: 'Courier New', monospace;
            font-weight: 600;
            color: var(--primary-color);
        }

        .amount-display {
            font-weight: 600;
            font-size: 1.1em;
            color: var(--success-color);
        }

        .table th {
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85em;
            letter-spacing: 0.5px;
        }

        .stats-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-left: 4px solid var(--primary-color);
        }
    </style>
</head>
<body>
<div class="container mt-4">
    <div class="header-card text-white rounded-3 p-4 mb-4">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <h2 class="mb-0"><i class="fas fa-file-invoice me-2"></i>Sales Invoices</h2>
                <p class="mb-0 opacity-75">Manage your sales invoices and track payments</p>
            </div>
            <button class="btn btn-light btn-lg" onclick="showNewInvoiceModal()">
                <i class="fas fa-plus me-2"></i>New Invoice
            </button>
        </div>
    </div>

    <!-- Stats Cards -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card stats-card">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h6 class="text-muted mb-1">Total Invoices</h6>
                            <h4 class="mb-0" id="totalInvoices">0</h4>
                        </div>
                        <div class="text-primary">
                            <i class="fas fa-file-invoice fa-2x"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card stats-card">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h6 class="text-muted mb-1">Total Amount</h6>
                            <h4 class="mb-0 text-success" id="totalAmount">₹0</h4>
                        </div>
                        <div class="text-success">
                            <i class="fas fa-rupee-sign fa-2x"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card stats-card">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h6 class="text-muted mb-1">Paid</h6>
                            <h4 class="mb-0 text-success" id="paidAmount">₹0</h4>
                        </div>
                        <div class="text-success">
                            <i class="fas fa-check-circle fa-2x"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card stats-card">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h6 class="text-muted mb-1">Pending</h6>
                            <h4 class="mb-0 text-warning" id="pendingAmount">₹0</h4>
                        </div>
                        <div class="text-warning">
                            <i class="fas fa-clock fa-2x"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="card shadow-sm">
        <div class="card-header bg-white d-flex justify-content-between align-items-center">
            <h5 class="mb-0">All Invoices</h5>
            <div class="filter-buttons btn-group" role="group">
                <button type="button" class="btn btn-outline-primary btn-sm active" data-filter="all">All</button>
                <button type="button" class="btn btn-outline-primary btn-sm" data-filter="PAID">Paid</button>
                <button type="button" class="btn btn-outline-primary btn-sm" data-filter="PENDING">Pending</button>
                <button type="button" class="btn btn-outline-primary btn-sm" data-filter="OVERDUE">Overdue</button>
            </div>
        </div>
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover mb-0">
                    <thead class="table-light">
                    <tr>
                        <th>Invoice #</th>
                        <th>Date</th>
                        <th>Customer</th>
                        <th>Amount</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                    </thead>
                    <tbody id="invoicesTableBody">
                    <!-- Invoices will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="mt-4">
        <button class="btn btn-outline-secondary" onclick="goToDashboard()">
            <i class="fas fa-arrow-left me-2"></i>Back to Dashboard
        </button>
    </div>
</div>

<!-- New Invoice Modal -->
<div class="modal fade" id="newInvoiceModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Create New Invoice</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="newInvoiceForm">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="customerName" class="form-label">Customer Name</label>
                            <input type="text" class="form-control" id="customerName" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="invoiceDate" class="form-label">Invoice Date</label>
                            <input type="date" class="form-control" id="invoiceDate" required>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="amount" class="form-label">Amount (₹)</label>
                            <input type="number" class="form-control" id="amount" min="0" step="0.01" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="status" class="form-label">Status</label>
                            <select class="form-control" id="status" required>
                                <option value="PENDING">Pending</option>
                                <option value="PAID">Paid</option>
                                <option value="OVERDUE">Overdue</option>
                            </select>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="description" class="form-label">Description (Optional)</label>
                        <textarea class="form-control" id="description" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="createInvoice()">Create Invoice</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // Sample data
    let invoices = [
        { id: 1, invoiceNumber: 'INV-001', date: '2025-01-15', customerName: 'Tech Solutions Ltd.', amount: 50000, status: 'PAID' },
        { id: 2, invoiceNumber: 'INV-002', date: '2025-01-20', customerName: 'Digital Marketing Co.', amount: 25000, status: 'PENDING' },
        { id: 3, invoiceNumber: 'INV-003', date: '2025-01-10', customerName: 'Creative Design Studio', amount: 35000, status: 'OVERDUE' },
        { id: 4, invoiceNumber: 'INV-004', date: '2025-01-25', customerName: 'E-commerce Ventures', amount: 75000, status: 'PAID' },
        { id: 5, invoiceNumber: 'INV-005', date: '2025-01-28', customerName: 'Startup Hub', amount: 15000, status: 'PENDING' }
    ];

    let nextInvoiceNumber = 6;
    let currentFilter = 'all';

    function generateInvoiceNumber() {
        return `INV-${String(nextInvoiceNumber++).padStart(3, '0')}`;
    }

    function getStatusBadge(status) {
        const badges = {
            'PAID': '<span class="badge badge-paid">Paid</span>',
            'PENDING': '<span class="badge badge-pending">Pending</span>',
            'OVERDUE': '<span class="badge badge-overdue">Overdue</span>'
        };
        return badges[status] || status;
    }

    function formatDate(dateString) {
        return new Date(dateString).toLocaleDateString('en-IN');
    }

    function formatCurrency(amount) {
        return new Intl.NumberFormat('en-IN', {
            style: 'currency',
            currency: 'INR',
            minimumFractionDigits: 0
        }).format(amount);
    }

    function updateStats() {
        const totalInvoices = invoices.length;
        const totalAmount = invoices.reduce((sum, inv) => sum + inv.amount, 0);
        const paidAmount = invoices.filter(inv => inv.status === 'PAID').reduce((sum, inv) => sum + inv.amount, 0);
        const pendingAmount = invoices.filter(inv => inv.status === 'PENDING').reduce((sum, inv) => sum + inv.amount, 0);

        document.getElementById('totalInvoices').textContent = totalInvoices;
        document.getElementById('totalAmount').textContent = formatCurrency(totalAmount);
        document.getElementById('paidAmount').textContent = formatCurrency(paidAmount);
        document.getElementById('pendingAmount').textContent = formatCurrency(pendingAmount);
    }

    function renderInvoices(invoicesToRender = invoices) {
        const tbody = document.getElementById('invoicesTableBody');

        if (invoicesToRender.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="6" class="text-center text-muted py-4 empty-state">
                        <i class="fas fa-file-invoice fa-2x mb-2 d-block"></i>
                        No invoices found. <button class="btn btn-link p-0" onclick="showNewInvoiceModal()">Create your first invoice</button>
                    </td>
                </tr>
            `;
            return;
        }

        tbody.innerHTML = invoicesToRender.map(invoice => `
            <tr>
                <td class="invoice-number">${invoice.invoiceNumber}</td>
                <td>${formatDate(invoice.date)}</td>
                <td>${invoice.customerName}</td>
                <td class="amount-display">${formatCurrency(invoice.amount)}</td>
                <td>${getStatusBadge(invoice.status)}</td>
                <td>
                    <div class="btn-group btn-group-sm">
                        <button class="btn btn-outline-primary" title="View" onclick="viewInvoice(${invoice.id})">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="btn btn-outline-info" title="Edit" onclick="editInvoice(${invoice.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-outline-danger" title="Delete" onclick="deleteInvoice(${invoice.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </td>
            </tr>
        `).join('');
    }

    function showNewInvoiceModal() {
        // Set today's date as default
        document.getElementById('invoiceDate').value = new Date().toISOString().split('T')[0];
        const modal = new bootstrap.Modal(document.getElementById('newInvoiceModal'));
        modal.show();
    }

    function createInvoice() {
        const customerName = document.getElementById('customerName').value;
        const date = document.getElementById('invoiceDate').value;
        const amount = parseFloat(document.getElementById('amount').value);
        const status = document.getElementById('status').value;

        if (!customerName || !date || !amount) {
            alert('Please fill in all required fields');
            return;
        }

        const newInvoice = {
            id: Date.now(), // Simple ID generation
            invoiceNumber: generateInvoiceNumber(),
            date: date,
            customerName: customerName,
            amount: amount,
            status: status
        };

        invoices.unshift(newInvoice); // Add to beginning of array
        renderInvoices(getFilteredInvoices());
        updateStats();

        // Reset form
        document.getElementById('newInvoiceForm').reset();

        // Close modal
        const modal = bootstrap.Modal.getInstance(document.getElementById('newInvoiceModal'));
        modal.hide();

        // Show success message
        showToast('Invoice created successfully!', 'success');
    }

    function viewInvoice(id) {
        const invoice = invoices.find(inv => inv.id === id);
        if (invoice) {
            alert(`Invoice Details:\n\nNumber: ${invoice.invoiceNumber}\nCustomer: ${invoice.customerName}\nAmount: ${formatCurrency(invoice.amount)}\nStatus: ${invoice.status}\nDate: ${formatDate(invoice.date)}`);
        }
    }

    function editInvoice(id) {
        const invoice = invoices.find(inv => inv.id === id);
        if (invoice) {
            const newStatus = prompt('Change status to:', invoice.status);
            if (newStatus && ['PAID', 'PENDING', 'OVERDUE'].includes(newStatus.toUpperCase())) {
                invoice.status = newStatus.toUpperCase();
                renderInvoices(getFilteredInvoices());
                updateStats();
                showToast('Invoice updated successfully!', 'success');
            }
        }
    }

    function deleteInvoice(id) {
        if (confirm('Are you sure you want to delete this invoice?')) {
            invoices = invoices.filter(invoice => invoice.id !== id);
            renderInvoices(getFilteredInvoices());
            updateStats();
            showToast('Invoice deleted successfully!', 'success');
        }
    }

    function getFilteredInvoices() {
        if (currentFilter === 'all') {
            return invoices;
        }
        return invoices.filter(invoice => invoice.status === currentFilter);
    }

    function showToast(message, type = 'info') {
        // Simple toast notification
        const toast = document.createElement('div');
        toast.className = `alert alert-${type} position-fixed`;
        toast.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
        toast.innerHTML = `
            ${message}
            <button type="button" class="btn-close float-end" onclick="this.parentElement.remove()"></button>
        `;
        document.body.appendChild(toast);

        setTimeout(() => {
            if (toast.parentElement) {
                toast.remove();
            }
        }, 3000);
    }

    function goToDashboard() {
        alert('Redirecting to dashboard...');
    }

    // Filter functionality
    document.querySelectorAll('.filter-buttons .btn').forEach(btn => {
        btn.addEventListener('click', function() {
            // Remove active class from all buttons
            document.querySelectorAll('.filter-buttons .btn').forEach(b => b.classList.remove('active'));
            // Add active class to clicked button
            this.classList.add('active');

            // Update current filter
            currentFilter = this.dataset.filter;

            // Render filtered invoices
            renderInvoices(getFilteredInvoices());
        });
    });

    // Initialize the page
    document.addEventListener('DOMContentLoaded', function() {
        renderInvoices();
        updateStats();
    });
</script>
</body>
</html>